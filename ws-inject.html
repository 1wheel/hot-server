<!-- hot-server appends this snippit to inject code via a websock  -->
<script>

!(function(){
  var lastUpdateTime = null

  window.setInterval(fetchUpdate, 250)

  function fetchUpdate(){
    fetch(location.origin + '/__hot-server-update')
      .then(res => res.json())
      .then(parseUpdate)
  }

  function parseUpdate({path, type, str, time}){
    if (time <= lastUpdateTime) return

    lastUpdateTime = time

    if (type == 'reload') location.reload()
    if (type == 'jsInject') eval(str)
    if (type == 'cssInject') {
      Array.from(document.querySelectorAll('link'))
        .filter(d => d.href.includes(path))
        .forEach(d => d.href = d.href)
    }
  }

})()
</script>